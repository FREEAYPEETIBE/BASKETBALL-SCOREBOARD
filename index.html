<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Basketball Scoreboard (Offline)</title>
<style>
  :root{
    --bg:#071029; --panel:#0f2846; --accent:#ffb400; --muted:#98a6bf;
    --btn:#183657; --btn-hover:#1f4a78;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{
    background:linear-gradient(180deg,#021227 0%, #031d2e 100%);
    color:#e8f0ff; display:flex; align-items:center; justify-content:center; padding:12px;
  }
  .app{width:100%; max-width:1100px;}
  .top{
    display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:12px;
  }
  .title{
    display:flex; gap:12px; align-items:center;
  }
  .logo{
    width:64px;height:64px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#ff6b6b); display:flex;align-items:center;justify-content:center;font-weight:700;color:#071227;
    box-shadow:0 6px 18px rgba(0,0,0,.45);
  }
  .title h1{margin:0;font-size:20px;letter-spacing:0.6px}
  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .control-btn{background:var(--btn);border:0;padding:10px 14px;border-radius:8px;color:white;font-weight:600;cursor:pointer}
  .control-btn:active{transform:translateY(1px)}
  .layout{
    display:grid; grid-template-columns: 1fr 380px; gap:12px;
  }
  .panel{
    background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border-radius:12px; padding:14px; box-shadow: 0 8px 30px rgba(3,12,30,0.6); border:1px solid rgba(255,255,255,0.03);
  }

  /* Main scoreboard */
  .scoreboard{display:flex;gap:12px;align-items:center;justify-content:space-between;}
  .team{
    flex:1; display:flex; flex-direction:column; gap:8px; align-items:center; justify-content:center; padding:12px;
    background:rgba(255,255,255,0.02); border-radius:10px; min-height:170px;
  }
  .team .name{font-size:20px;font-weight:700}
  .score{font-size:64px;font-weight:900;letter-spacing:3px}
  .score-btns{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
  .score-btn{padding:10px 14px;border-radius:10px;border:0;background:var(--accent);color:#071227;font-weight:800;cursor:pointer}
  .small{font-size:14px;padding:8px 10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);}

  /* Right column */
  .right-col{display:flex;flex-direction:column;gap:12px}
  .clock{
    display:flex; gap:12px; align-items:center; justify-content:space-between;
    background:linear-gradient(90deg,#021b35 0%, #042a4a 100%); padding:14px; border-radius:10px;
  }
  .time{
    font-size:48px;font-weight:900; letter-spacing:2px;
  }
  .meta{display:flex;gap:12px;align-items:center}
  .meta .item{display:flex;flex-direction:column;align-items:center}
  .meta label{font-size:12px;color:var(--muted); margin-bottom:6px}
  .meta .value{font-size:20px;font-weight:800}

  /* shot clock display */
  .shot{
    display:flex; gap:10px; align-items:center; justify-content:space-between; padding:12px; background:rgba(255,255,255,0.02); border-radius:10px;
  }
  .shot .display{font-size:40px;font-weight:900;color:#ff4d4d}
  .shot-controls{display:flex;gap:8px;align-items:center}

  /* other controls */
  .row{display:flex;gap:8px;flex-wrap:wrap}
  input[type="text"], input[type="number"]{
    background:transparent;border:1px solid rgba(255,255,255,0.06); padding:8px 10px;border-radius:8px;color:inherit;
    outline:none; min-width:90px;
  }

  .fouls{display:flex;gap:8px;align-items:center}
  .footer-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}

  /* responsive */
  @media (max-width:880px){
    .layout{grid-template-columns:1fr; }
    .right-col{order:2}
    .top{flex-direction:column;align-items:stretch}
  }
</style>
</head>
<body>
<div class="app">
  <div class="top">
    <div class="title">
      <div class="logo">B</div>
      <div>
        <h1>Basketball Scoreboard</h1>
        <div style="font-size:12px;color:var(--muted)">Standalone — works offline on PC / Android / iOS / Tablet</div>
      </div>
    </div>

    <div class="controls">
      <button id="fullscreenBtn" class="control-btn">Fullscreen</button>
      <button id="saveBtn" class="control-btn">Save</button>
      <button id="loadBtn" class="control-btn">Load</button>
      <button id="resetGameBtn" class="control-btn">Reset Game</button>
    </div>
  </div>

  <div class="layout">
    <div class="panel">
      <div class="scoreboard">
        <div class="team" id="teamA">
          <input id="teamAName" type="text" value="Home" />
          <div class="score" id="scoreA">0</div>
          <div class="score-btns">
            <button class="score-btn" data-team="A" data-add="1">+1</button>
            <button class="score-btn" data-team="A" data-add="2">+2</button>
            <button class="score-btn" data-team="A" data-add="3">+3</button>
            <button class="small" data-team="A" id="resetScoreA">Reset</button>
          </div>
          <div class="fouls" style="margin-top:10px">
            <div>
              <label style="font-size:12px;color:var(--muted)">Fouls</label>
              <div style="display:flex;gap:8px;align-items:center">
                <button class="small" data-team="A" id="foulAminus">-</button>
                <div id="foulA" style="font-weight:800">0</div>
                <button class="small" data-team="A" id="foulAplus">+</button>
              </div>
            </div>
          </div>
        </div>

        <div style="width:18px"></div>

        <div class="team" id="teamB">
          <input id="teamBName" type="text" value="Away" />
          <div class="score" id="scoreB">0</div>
          <div class="score-btns">
            <button class="score-btn" data-team="B" data-add="1">+1</button>
            <button class="score-btn" data-team="B" data-add="2">+2</button>
            <button class="score-btn" data-team="B" data-add="3">+3</button>
            <button class="small" data-team="B" id="resetScoreB">Reset</button>
          </div>
          <div class="fouls" style="margin-top:10px">
            <div>
              <label style="font-size:12px;color:var(--muted)">Fouls</label>
              <div style="display:flex;gap:8px;align-items:center">
                <button class="small" data-team="B" id="foulBminus">-</button>
                <div id="foulB" style="font-weight:800">0</div>
                <button class="small" data-team="B" id="foulBplus">+</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top:12px; display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between;">
        <div style="display:flex;gap:8px;align-items:center">
          <label style="font-size:12px;color:var(--muted)">Quarter length (mm:ss)</label>
          <input id="quarterMinutes" type="number" min="0" value="10" style="width:70px"/> :
          <input id="quarterSeconds" type="number" min="0" max="59" value="0" style="width:70px"/>
        </div>

        <div style="display:flex;gap:8px;align-items:center">
          <label style="font-size:12px;color:var(--muted)">Quarter</label>
          <div class="small" id="quarterDisplay">1</div>
          <button class="small" id="prevQuarter">←</button>
          <button class="small" id="nextQuarter">→</button>
        </div>

        <div style="display:flex;gap:8px;align-items:center">
          <label style="font-size:12px;color:var(--muted)">Buzzer Volume</label>
          <input id="buzzerVol" type="range" min="0" max="1" step="0.05" value="0.8" />
        </div>
      </div>

      <div class="footer-actions">
        <div style="flex:1"></div>
        <button id="startPauseBtn" class="control-btn">Start</button>
        <button id="resetClocksBtn" class="control-btn">Reset Clocks</button>
      </div>
    </div>

    <div class="right-col">
      <div class="panel clock">
        <div>
          <div style="font-size:12px;color:var(--muted)">Game Clock</div>
          <div class="time" id="gameClock">10:00</div>
        </div>

        <div class="meta">
          <div class="item">
            <label>Possession</label>
            <div class="value" id="possession">A</div>
          </div>
          <div class="item">
            <label>Timeouts A</label>
            <div class="value" id="timeoutsA">3</div>
          </div>
          <div class="item">
            <label>Timeouts B</label>
            <div class="value" id="timeoutsB">3</div>
          </div>
        </div>
      </div>

      <div class="panel shot">
        <div>
          <div style="font-size:12px;color:var(--muted)">Shot Clock</div>
          <div class="display" id="shotClock">24.0</div>
        </div>

        <div class="shot-controls">
          <div style="display:flex;flex-direction:column;gap:6px">
            <button class="small" id="reset24">Reset 24</button>
            <button class="small" id="reset14">Reset 14</button>
          </div>

          <div style="display:flex;flex-direction:column;gap:6px">
            <label style="font-size:12px;color:var(--muted)">Custom</label>
            <input id="customShotSeconds" type="number" min="1" value="24" />
            <button class="small" id="applyCustomShot">Apply</button>
          </div>
        </div>
      </div>

      <div class="panel">
        <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
          <label style="font-size:12px;color:var(--muted)">Shot Clock Behavior</label>
          <div style="font-size:13px;color:var(--muted)">Starts / pauses with main clock</div>
        </div>

        <div style="margin-top:12px">
          <label style="font-size:12px;color:var(--muted)">Keyboard shortcuts</label>
          <ul style="margin:8px 0 0 18px; color:var(--muted)">
            <li>Space = Start / Pause game (and shot clock)</li>
            <li>R = Reset Clocks</li>
            <li>1/2/3 keys add points to Home (A)</li>
            <li>7/8/9 keys add points to Away (B)</li>
            <li>S = Reset shot clock to default</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* -----------------------
   Simple scoreboard logic
   ----------------------- */
(function(){
  // Elements
  const scoreAEl = document.getElementById('scoreA');
  const scoreBEl = document.getElementById('scoreB');
  const teamAName = document.getElementById('teamAName');
  const teamBName = document.getElementById('teamBName');
  const foulAEl = document.getElementById('foulA');
  const foulBEl = document.getElementById('foulB');
  const quarterDisplay = document.getElementById('quarterDisplay');
  const gameClockEl = document.getElementById('gameClock');
  const shotClockEl = document.getElementById('shotClock');
  const startPauseBtn = document.getElementById('startPauseBtn');
  const resetClocksBtn = document.getElementById('resetClocksBtn');
  const reset24Btn = document.getElementById('reset24');
  const reset14Btn = document.getElementById('reset14');
  const customShotInput = document.getElementById('customShotSeconds');
  const applyCustomBtn = document.getElementById('applyCustomShot');
  const quarterMinInput = document.getElementById('quarterMinutes');
  const quarterSecInput = document.getElementById('quarterSeconds');
  const prevQuarterBtn = document.getElementById('prevQuarter');
  const nextQuarterBtn = document.getElementById('nextQuarter');
  const possessionEl = document.getElementById('possession');
  const buzzerVol = document.getElementById('buzzerVol');

  // Buttons
  const scoreButtons = Array.from(document.querySelectorAll('.score-btn'));
  const resetScoreA = document.getElementById('resetScoreA');
  const resetScoreB = document.getElementById('resetScoreB');
  const foulAplus = document.getElementById('foulAplus');
  const foulAminus = document.getElementById('foulAminus');
  const foulBplus = document.getElementById('foulBplus');
  const foulBminus = document.getElementById('foulBminus');

  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const saveBtn = document.getElementById('saveBtn');
  const loadBtn = document.getElementById('loadBtn');
  const resetGameBtn = document.getElementById('resetGameBtn');

  // State
  let scoreA = 0, scoreB = 0, foulA = 0, foulB = 0;
  let quarter = 1;
  let timePerQuarter = (parseInt(quarterMinInput.value||10)*60) + parseInt(quarterSecInput.value||0);
  let gameTime = timePerQuarter; // seconds
  let gameRunning = false;
  let gameTimerInterval = null;

  let shotDefault = parseFloat(customShotInput.value) || 24;
  let shotTime = shotDefault; // seconds (with decimals)
  let shotRunning = false;
  let shotInterval = null;
  const shotTickMs = 100; // update every 100ms for 1 decimal display

  // Audio buzzer via WebAudio
  const audioCtx = (window.AudioContext || window.webkitAudioContext) ? new (window.AudioContext || window.webkitAudioContext)() : null;
  function playBuzzer(durationSec=0.6, freq=800){
    if(!audioCtx) return;
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = 'sine';
    o.frequency.value = freq;
    g.gain.value = buzzerVol.value;
    o.connect(g); g.connect(audioCtx.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + durationSec);
    o.stop(audioCtx.currentTime + durationSec + 0.02);
  }

  // display helpers
  function formatMMSS(totalSec){
    totalSec = Math.max(0, Math.floor(totalSec));
    const mm = Math.floor(totalSec/60);
    const ss = totalSec%60;
    return `${mm}:${ss.toString().padStart(2,'0')}`;
  }
  function formatShot(t){
    if(t<=0) return '0.0';
    const s = Math.floor(t);
    const dec = Math.floor((t - s) * 10);
    return `${s}.${dec}`;
  }

  // render
  function render(){
    scoreAEl.textContent = String(scoreA);
    scoreBEl.textContent = String(scoreB);
    foulAEl.textContent = String(foulA);
    foulBEl.textContent = String(foulB);
    quarterDisplay.textContent = String(quarter);
    gameClockEl.textContent = formatMMSS(gameTime);
    shotClockEl.textContent = formatShot(shotTime);
  }

  // core timer logic: starts/pauses both game and shot clocks per Option A
  function startGame(){
    if(gameRunning) return;
    gameRunning = true;
    startPauseBtn.textContent = 'Pause';
    // start game interval (1s)
    gameTimerInterval = setInterval(()=>{
      if(gameTime > 0){
        gameTime = Math.max(0, gameTime - 1);
        // If game clock reaches zero -> buzzer
        if(gameTime === 0){
          playBuzzer(1.0, 700);
          // stop running (you may want to stop shotclock too)
          stopGame();
        }
      } else {
        stopGame();
      }
      render();
    }, 1000);

    // start shot clock ticks
    shotRunning = true;
    shotInterval = setInterval(()=>{
      if(shotTime > 0){
        shotTime = Math.max(0, +(shotTime - (shotTickMs/1000)).toFixed(3));
        if(shotTime <= 0){
          playBuzzer(0.6, 1000); // shot clock buzzer
        }
      }
      render();
    }, shotTickMs);
  }

  function stopGame(){
    gameRunning = false;
    startPauseBtn.textContent = 'Start';
    clearInterval(gameTimerInterval); gameTimerInterval = null;
    clearInterval(shotInterval); shotInterval = null;
    shotRunning = false;
  }

  function toggleStartPause(){
    if(gameRunning) stopGame();
    else {
      // Ensure audio context resume on gesture
      if(audioCtx && audioCtx.state === 'suspended'){
        audioCtx.resume();
      }
      startGame();
    }
  }

  // Reset clocks to configured quarter length and shot default
  function resetClocks(){
    timePerQuarter = (parseInt(quarterMinInput.value||0)*60) + parseInt(quarterSecInput.value||0);
    gameTime = timePerQuarter;
    shotDefault = parseFloat(customShotInput.value) || 24;
    shotTime = shotDefault;
    render();
  }

  // Quick reset functions
  function resetTo24(){ shotDefault = 24; customShotInput.value = 24; shotTime = shotDefault; render(); }
  function resetTo14(){ shotDefault = 14; customShotInput.value = 14; shotTime = shotDefault; render(); }
  function applyCustomShot(){ shotDefault = Math.max(1, parseFloat(customShotInput.value)||24); shotTime = shotDefault; render(); }

  // score changes
  scoreButtons.forEach(b=>{
    b.addEventListener('click', ()=> {
      const team = b.getAttribute('data-team');
      const add = parseInt(b.getAttribute('data-add')||0);
      if(team === 'A') scoreA += add;
      else scoreB += add;
      // On score we may reset shot clock (common rule: reset to 24 on field goal for opponent). 
      // We'll simply reset to default shot clock for the team that got possession change:
      // Toggle possession to the other team and reset shot clock.
      possessionEl.textContent = (possessionEl.textContent === 'A') ? 'B' : 'A';
      shotTime = shotDefault;
      render();
    });
  });

  // Reset scores
  resetScoreA.addEventListener('click', ()=> { scoreA = 0; render(); });
  resetScoreB.addEventListener('click', ()=> { scoreB = 0; render(); });

  // Fouls
  foulAplus.addEventListener('click', ()=> { foulA++; render(); });
  foulAminus.addEventListener('click', ()=> { foulA = Math.max(0, foulA-1); render(); });
  foulBplus.addEventListener('click', ()=> { foulB++; render(); });
  foulBminus.addEventListener('click', ()=> { foulB = Math.max(0, foulB-1); render(); });

  // Quarter controls
  prevQuarterBtn.addEventListener('click', ()=> { quarter = Math.max(1, quarter-1); resetClocks(); render(); });
  nextQuarterBtn.addEventListener('click', ()=> { quarter++; resetClocks(); render(); });

  // Start/pause/reset
  startPauseBtn.addEventListener('click', toggleStartPause);
  resetClocksBtn.addEventListener('click', ()=>{ resetClocks(); });

  // Shot clock quick resets
  reset24Btn.addEventListener('click', resetTo24);
  reset14Btn.addEventListener('click', resetTo14);
  applyCustomBtn.addEventListener('click', applyCustomShot);

  // Keyboard shortcuts
  window.addEventListener('keydown', (e)=>{
    if(e.code === 'Space'){ e.preventDefault(); toggleStartPause(); }
    if(e.key === 'r' || e.key === 'R'){ resetClocks(); render(); }
    if(e.key === 's' || e.key === 'S'){ shotTime = shotDefault; render(); }
    // score keys
    if(e.key === '1') { scoreA += 1; possessionEl.textContent = 'B'; shotTime = shotDefault; render(); }
    if(e.key === '2') { scoreA += 2; possessionEl.textContent = 'B'; shotTime = shotDefault; render(); }
    if(e.key === '3') { scoreA += 3; possessionEl.textContent = 'B'; shotTime = shotDefault; render(); }
    if(e.key === '7') { scoreB += 1; possessionEl.textContent = 'A'; shotTime = shotDefault; render(); }
    if(e.key === '8') { scoreB += 2; possessionEl.textContent = 'A'; shotTime = shotDefault; render(); }
    if(e.key === '9') { scoreB += 3; possessionEl.textContent = 'A'; shotTime = shotDefault; render(); }
  });

  // Fullscreen
  fullscreenBtn.addEventListener('click', ()=>{
    const el = document.documentElement;
    if(!document.fullscreenElement) el.requestFullscreen?.();
    else document.exitFullscreen?.();
  });

    // Save / Load state (localStorage)
  saveBtn.addEventListener('click', ()=>{
    const state = {
      scoreA, scoreB, foulA, foulB, quarter, gameTime, shotTime, shotDefault,
      teamAName: teamAName.value, teamBName: teamBName.value,
      quarterMinInput: quarterMinInput.value, quarterSecInput: quarterSecInput.value
    };
    localStorage.setItem('bb_score_state', JSON.stringify(state));
    alert('Saved locally.');
  });
  loadBtn.addEventListener('click', ()=>{
    const s = localStorage.getItem('bb_score_state');
    if(!s){ alert('No saved game found.'); return; }
    try{
      const st = JSON.parse(s);
      scoreA = st.scoreA||0; scoreB = st.scoreB||0;
      foulA = st.foulA||0; foulB = st.foulB||0;
      quarter = st.quarter||1; gameTime = st.gameTime ?? timePerQuarter;
      shotTime = st.shotTime ?? shotDefault; shotDefault = st.shotDefault ?? shotDefault;
      teamAName.value = st.teamAName||teamAName.value; teamBName.value = st.teamBName||teamBName.value;
      quarterMinInput.value = st.quarterMinInput || quarterMinInput.value;
      quarterSecInput.value = st.quarterSecInput || quarterSecInput.value;
      render();
    }catch(err){ alert('Failed to load: '+err); }
  });

  // Reset full game
  resetGameBtn.addEventListener('click', ()=>{
    if(!confirm('Reset entire game (scores, fouls, quarter, clocks)?')) return;
    scoreA=0; scoreB=0; foulA=0; foulB=0; quarter=1;
    quarterMinInput.value = 10; quarterSecInput.value = 0;
    customShotInput.value = 24; shotDefault = 24;
    timePerQuarter = (parseInt(quarterMinInput.value)*60) + parseInt(quarterSecInput.value);
    gameTime = timePerQuarter; shotTime = shotDefault;
    possessionEl.textContent = 'A';
    stopGame();
    render();
  });

  // ensure resetting clocks updates timePerQuarter
  quarterMinInput.addEventListener('change', ()=> { timePerQuarter = (parseInt(quarterMinInput.value||0)*60) + parseInt(quarterSecInput.value||0); gameTime = timePerQuarter; render(); });
  quarterSecInput.addEventListener('change', ()=> { timePerQuarter = (parseInt(quarterMinInput.value||0)*60) + parseInt(quarterSecInput.value||0); gameTime = timePerQuarter; render(); });

  // initial render
  render();

  // expose a small debug in window if needed
  window._scoreboard = {
    getState: ()=>({scoreA,scoreB,foulA,foulB,quarter,gameTime,shotTime,shotDefault,gameRunning})
  };
})();
</script>
</body>
</html>
