<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Broadcast Basketball Scoreboard</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#000814; --panel:#021029; --accent:#ff8a00; --clock:#ffd24d; --shot:#28f1ff; --score-red:#ff4d4d;
    --text:#ffffff; --muted:#98a6bf; --control-bg: rgba(255,255,255,0.03);
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{
    background:linear-gradient(180deg,#000814 0%, #021022 100%);
    color:var(--text);
    display:flex; flex-direction:column; align-items:center; padding:8px;
  }
  .container{width:100%; max-width:1400px;}
  /* Top broadcast display */
  .display {
    display:flex; flex-direction:column; gap:10px; padding:18px; border-radius:12px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03); box-shadow:0 18px 60px rgba(0,0,0,0.7);
  }
  .display-row{
    display:flex; align-items:center; justify-content:space-between;
    gap:12px;
  }
  .team-block{
    display:flex; flex-direction:column; align-items:center; width:38%;
  }
  .team-name{
    font-family: "Orbitron", sans-serif; font-weight:700; font-size:30px;
    letter-spacing:2px; color:var(--muted);
    text-transform:uppercase;
    text-align:center;
  }
  .team-score{
    font-family: "Orbitron", sans-serif; font-size:130px; font-weight:900;
    line-height:0.95;
    text-shadow: 0 6px 28px rgba(255,138,0,0.15), 0 0 30px rgba(255,138,0,0.12);
    color: var(--accent);
    margin-top:6px;
  }
  .center-block{
    display:flex; flex-direction:column; align-items:center; gap:10px; width:24%;
  }
  .game-clock{
    font-family: "Orbitron", sans-serif; font-size:120px; font-weight:900; color:var(--clock);
    text-shadow: 0 8px 40px rgba(255,210,77,0.14), 0 0 45px rgba(255,210,77,0.09);
  }
  .meta-row{
    display:flex; gap:12px; align-items:center; justify-content:center;
  }
  .meta-item{
    display:flex; flex-direction:column; align-items:center;
  }
  .meta-label{font-size:14px;color:var(--muted); font-weight:600}
  .meta-value{font-family: "Orbitron", sans-serif; font-size:44px; font-weight:800; color:var(--text);
    text-shadow: 0 8px 30px rgba(255,255,255,0.02);
  }

  /* Shot clock & fouls row */
  .lower-row{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-top:4px;}
  .shot {
    display:flex; flex-direction:column; align-items:center; gap:6px; width:220px;
  }
  .shot-display{
    font-family: "Orbitron", sans-serif; font-size:66px; font-weight:900; color:var(--shot);
    text-shadow: 0 8px 30px rgba(40,241,255,0.12), 0 0 30px rgba(40,241,255,0.08);
    padding:4px 12px; border-radius:8px; background: rgba(255,255,255,0.01);
  }
  .shot-display.blink{ color:#ffb4b4; text-shadow: 0 8px 40px rgba(255,77,77,0.25), 0 0 40px rgba(255,77,77,0.18); }

  .foul-block{display:flex;flex-direction:column;align-items:center; gap:6px; width:180px;}
  .foul-value{
    font-family: "Orbitron", sans-serif; font-size:46px; font-weight:800; color:#ffffff;
    text-shadow: 0 10px 30px rgba(255,255,255,0.02);
  }

  /* Bottom control panel (separated) */
  .controls-panel{
    margin-top:12px; display:flex; gap:12px; padding:12px; border-radius:10px;
    background:var(--control-bg); align-items:flex-start; flex-wrap:wrap;
  }
  .col{display:flex;flex-direction:column; gap:8px;}
  .btn{padding:10px 14px;border-radius:8px;border:0;cursor:pointer;font-weight:700}
  .btn-add{background:#0ea5a5;color:#001219}
  .btn-score{background:var(--accent); color:#071421}
  .btn-danger{background:#ff4d4d; color:#200}
  .btn-small{padding:8px 10px;border-radius:6px;background:rgba(255,255,255,0.03);color:var(--text);border:1px solid rgba(255,255,255,0.04)}
  .input {padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--text)}

  /* Broadcast / fullscreen controls */
  .utility {display:flex;gap:8px; margin-left:auto}
  .control-row {display:flex; gap:8px; align-items:center; flex-wrap:wrap;}

  /* responsive */
  @media (max-width:1000px){
    .team-score{font-size:86px}
    .game-clock{font-size:64px}
    .team-name{font-size:20px}
    .shot-display{font-size:44px}
    .meta-value{font-size:32px}
    .container{padding:6px}
  }
  @media (max-width:600px){
    .display{padding:12px}
    .team-block, .center-block{width:100%}
    .display-row{flex-direction:column; align-items:center}
    .lower-row{flex-direction:column; align-items:center}
    .controls-panel{flex-direction:column}
  }
</style>
</head>
<body>
<div class="container">
  <!-- Display (broadcast) -->
  <div id="broadcastDisplay" class="display" aria-hidden="false">
    <div class="display-row">
      <div class="team-block" id="displayA">
        <div class="team-name" id="dispTeamA">HOME</div>
        <div class="team-score" id="dispScoreA">0</div>
      </div>

      <div class="center-block">
        <div class="game-clock" id="dispGameClock">10:00</div>
        <div class="meta-row">
          <div class="meta-item"><div class="meta-label">Quarter</div><div class="meta-value" id="dispQuarter">1</div></div>
          <div class="meta-item"><div class="meta-label">Poss</div><div class="meta-value" id="dispPoss">A</div></div>
        </div>
      </div>

      <div class="team-block" id="displayB">
        <div class="team-name" id="dispTeamB">AWAY</div>
        <div class="team-score" id="dispScoreB">0</div>
      </div>
    </div>

    <div class="lower-row">
      <div class="foul-block">
        <div class="meta-label">Fouls A</div>
        <div class="foul-value" id="dispFoulA">0</div>
      </div>

      <div class="shot">
        <div class="meta-label">Shot Clock</div>
        <div class="shot-display" id="dispShot">24.0</div>
      </div>

      <div class="foul-block">
        <div class="meta-label">Fouls B</div>
        <div class="foul-value" id="dispFoulB">0</div>
      </div>
    </div>
  </div>

  <!-- Controls (bottom) -->
  <div class="controls-panel" id="controlsPanel" role="region" aria-label="Control Panel">
    <div class="col" style="min-width:220px">
      <div style="display:flex;gap:8px;align-items:center">
        <input id="teamAInput" class="input" value="HOME" />
        <button class="btn btn-small" id="applyNames">Apply</button>
      </div>

      <div style="display:flex;gap:8px">
        <button class="btn btn-score" data-team="A" data-add="1">A +1</button>
        <button class="btn btn-score" data-team="A" data-add="2">A +2</button>
        <button class="btn btn-score" data-team="A" data-add="3">A +3</button>
        <button class="btn btn-small" id="resetA">A Reset</button>
      </div>

      <div style="display:flex;gap:6px;align-items:center">
        <div>Fouls:</div>
        <button class="btn btn-small" id="foulAminus">-</button>
        <div id="foulAcontrol" style="font-weight:800;min-width:28px;text-align:center">0</div>
        <button class="btn btn-small" id="foulAplus">+</button>
        <button class="btn btn-danger" id="clearFoulA">Clear</button>
      </div>
    </div>

    <div class="col" style="min-width:260px">
      <div style="display:flex;gap:8px;align-items:center">
        <input id="teamBInput" class="input" value="AWAY" />
      </div>

      <div style="display:flex;gap:8px">
        <button class="btn btn-score" data-team="B" data-add="1">B +1</button>
        <button class="btn btn-score" data-team="B" data-add="2">B +2</button>
        <button class="btn btn-score" data-team="B" data-add="3">B +3</button>
        <button class="btn btn-small" id="resetB">B Reset</button>
      </div>

      <div style="display:flex;gap:6px;align-items:center">
        <div>Fouls:</div>
        <button class="btn btn-small" id="foulBminus">-</button>
        <div id="foulBcontrol" style="font-weight:800;min-width:28px;text-align:center">0</div>
        <button class="btn btn-small" id="foulBplus">+</button>
        <button class="btn btn-danger" id="clearFoulB">Clear</button>
      </div>
    </div>

    <div class="col" style="min-width:220px">
      <div style="display:flex;gap:8px;align-items:center">
        <label style="font-size:13px;color:var(--muted)">Game Time (mm:ss)</label>
        <input id="gameTimeInput" class="input" placeholder="10:00" style="width:100px"/>
        <button class="btn btn-small" id="applyGameTime">Apply</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:6px">
        <button class="btn btn-add" id="startPause">Start</button>
        <button class="btn btn-small" id="resetClocks">Reset Clocks</button>
        <button class="btn btn-danger" id="stopAll">Stop</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
        <label style="font-size:13px;color:var(--muted)">Quarter</label>
        <button class="btn btn-small" id="prevQ">◀</button>
        <div id="quarterControl" style="font-weight:800;min-width:30px;text-align:center">1</div>
        <button class="btn btn-small" id="nextQ">▶</button>
      </div>
    </div>

    <div class="col" style="min-width:220px">
      <div style="display:flex;gap:8px;align-items:center">
        <label style="font-size:13px;color:var(--muted)">Shot Clock</label>
        <input id="customShotInput" class="input" style="width:90px" value="24" />
        <button class="btn btn-small" id="applyShot">Apply</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:6px">
        <button class="btn btn-small" id="reset24">Reset 24</button>
        <button class="btn btn-small" id="reset14">Reset 14</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:10px;align-items:center">
        <button class="btn btn-small" id="swapPoss">Toggle Poss</button>
        <div style="margin-left:auto" class="control-row">
          <button class="btn btn-small" id="broadcastMode">Broadcast Mode</button>
          <button class="btn btn-small" id="fullscreenBtn">Fullscreen</button>
          <button class="btn btn-small" id="saveBtn">Save</button>
          <button class="btn btn-small" id="loadBtn">Load</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  // Elements
  const dispTeamA = document.getElementById('dispTeamA');
  const dispTeamB = document.getElementById('dispTeamB');
  const dispScoreA = document.getElementById('dispScoreA');
  const dispScoreB = document.getElementById('dispScoreB');
  const dispGameClock = document.getElementById('dispGameClock');
  const dispShot = document.getElementById('dispShot');
  const dispFoulA = document.getElementById('dispFoulA');
  const dispFoulB = document.getElementById('dispFoulB');
  const dispQuarter = document.getElementById('dispQuarter');
  const dispPoss = document.getElementById('dispPoss');

  const teamAInput = document.getElementById('teamAInput');
  const teamBInput = document.getElementById('teamBInput');
  const applyNamesBtn = document.getElementById('applyNames');

  const scoreBtns = Array.from(document.querySelectorAll('.btn-score'));
  const resetA = document.getElementById('resetA');
  const resetB = document.getElementById('resetB');

  const foulAplus = document.getElementById('foulAplus');
  const foulAminus = document.getElementById('foulAminus');
  const foulBplus = document.getElementById('foulBplus');
  const foulBminus = document.getElementById('foulBminus');
  const foulAcontrol = document.getElementById('foulAcontrol');
  const foulBcontrol = document.getElementById('foulBcontrol');
  const clearFoulA = document.getElementById('clearFoulA');
  const clearFoulB = document.getElementById('clearFoulB');

  const startPauseBtn = document.getElementById('startPause');
  const resetClocksBtn = document.getElementById('resetClocks');
  const stopAllBtn = document.getElementById('stopAll');
  const gameTimeInput = document.getElementById('gameTimeInput');
  const applyGameTimeBtn = document.getElementById('applyGameTime');

  const prevQ = document.getElementById('prevQ');
  const nextQ = document.getElementById('nextQ');
  const quarterControl = document.getElementById('quarterControl');

  const customShotInput = document.getElementById('customShotInput');
  const applyShotBtn = document.getElementById('applyShot');
  const reset24Btn = document.getElementById('reset24');
  const reset14Btn = document.getElementById('reset14');

  const swapPossBtn = document.getElementById('swapPoss');
  const broadcastModeBtn = document.getElementById('broadcastMode');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const controlsPanel = document.getElementById('controlsPanel');
  const broadcastDisplay = document.getElementById('broadcastDisplay');
  const saveBtn = document.getElementById('saveBtn');
  const loadBtn = document.getElementById('loadBtn');

  // buzzer
  const AudioCtx = (window.AudioContext || window.webkitAudioContext) ? new (window.AudioContext || window.webkitAudioContext)() : null;
  function playTone(freq=800, dur=0.6){
    if(!AudioCtx) return;
    const o = AudioCtx.createOscillator();
    const g = AudioCtx.createGain();
    o.type = 'sine'; o.frequency.value = freq;
    g.gain.value = 0.5;
    o.connect(g); g.connect(AudioCtx.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, AudioCtx.currentTime + dur);
    o.stop(AudioCtx.currentTime + dur + 0.02);
  }

  // State
  let scoreA = 0, scoreB = 0;
  let foulA = 0, foulB = 0;
  let quarter = 1;
  let possession = 'A';

  // Game clock (seconds)
  const defaultMinutes = 10;
  let timePerQuarter = defaultMinutes * 60;
  let gameTime = timePerQuarter;
  let running = false;
  let gameInterval = null;

  // Shot clock (decimal seconds)
  let shotDefault = parseFloat(customShotInput.value) || 24;
  let shotTime = shotDefault;
  let shotInterval = null;
  const shotTickMs = 100; // 100ms for tenths

  // Helper format
  function formatMMSS(sec){
    sec = Math.max(0, Math.floor(sec));
    const mm = Math.floor(sec/60);
    const ss = sec % 60;
    return `${mm}:${ss.toString().padStart(2,'0')}`;
  }
  function formatShot(t){
    if(t<=0) return '0.0';
    const whole = Math.floor(t);
    const dec = Math.floor((t - whole) * 10);
    return `${whole}.${dec}`;
  }

  // render display
  function renderDisplay(){
    dispTeamA.textContent = teamAInput.value.toUpperCase();
    dispTeamB.textContent = teamBInput.value.toUpperCase();
    dispScoreA.textContent = scoreA;
    dispScoreB.textContent = scoreB;
    dispGameClock.textContent = formatMMSS(gameTime);
    dispShot.textContent = formatShot(shotTime);
    dispFoulA.textContent = foulA;
    dispFoulB.textContent = foulB;
    dispQuarter.textContent = quarter;
    dispPoss.textContent = possession;
    foulAcontrol.textContent = foulA;
    foulBcontrol.textContent = foulB;

    // shot blink if under 5 seconds
    const shotEl = document.getElementById('dispShot');
    if(shotTime <= 5 && shotTime > 0){
      shotEl.classList.add('blink');
    } else shotEl.classList.remove('blink');
  }

  // core timers
  function startAll(){
    if(running) return;
    running = true;
    startPauseBtn.textContent = 'Pause';
    // game tick (1s)
    gameInterval = setInterval(()=>{
      if(gameTime > 0){
        gameTime = Math.max(0, gameTime - 1);
        if(gameTime === 0){
          // end of quarter
          playTone(700, 1.2);
        }
      } else {
        stopAllTimers(); // stop if reached 0
      }
      renderDisplay();
    }, 1000);
    // shot tick
    shotInterval = setInterval(()=>{
      if(shotTime > 0){
        shotTime = Math.max(0, +(shotTime - (shotTickMs/1000)).toFixed(3));
        if(shotTime <= 0){
          // shot buzzer
          playTone(1200, 0.6);
        }
      }
      renderDisplay();
    }, shotTickMs);
    // resume audio context on user gesture if necessary
    if(AudioCtx && AudioCtx.state === 'suspended') AudioCtx.resume();
  }
  function pauseAll(){
    running = false;
    startPauseBtn.textContent = 'Start';
    clearInterval(gameInterval); gameInterval = null;
    clearInterval(shotInterval); shotInterval = null;
  }
  function stopAllTimers(){
    pauseAll();
    // optionally reset clocks? no — leave at zero
  }

  // control handlers
  scoreBtns.forEach(b=>{
    b.addEventListener('click', ()=>{
      const team = b.getAttribute('data-team');
      const add = parseInt(b.getAttribute('data-add')||0);
      if(team === 'A') scoreA += add;
      else scoreB += add;
      // toggle possession and reset shot to default (common rule after score)
      possession = (team === 'A') ? 'B' : 'A';
      shotTime = shotDefault;
      renderDisplay();
    });
  });
  resetA.addEventListener('click', ()=>{ scoreA = 0; renderDisplay(); });
  resetB.addEventListener('click', ()=>{ scoreB = 0; renderDisplay(); });

  foulAplus.addEventListener('click', ()=>{ foulA++; renderDisplay(); });
  foulAminus.addEventListener('click', ()=>{ foulA = Math.max(0, foulA-1); renderDisplay(); });
  foulBplus.addEventListener('click', ()=>{ foulB++; renderDisplay(); });
  foulBminus.addEventListener('click', ()=>{ foulB = Math.max(0, foulB-1); renderDisplay(); });
  clearFoulA.addEventListener('click', ()=>{ foulA=0; renderDisplay(); });
  clearFoulB.addEventListener('click', ()=>{ foulB=0; renderDisplay(); });

  startPauseBtn.addEventListener('click', ()=>{
    if(running) pauseAll(); else startAll();
  });
  resetClocksBtn.addEventListener('click', ()=>{
    // resets to configured values
    timePerQuarter = parseInt((Math.floor((timePerQuarter/60)||10))) * 60; // keep same min by default
    gameTime = timePerQuarter;
    shotDefault = parseFloat(customShotInput.value) || 24;
    shotTime = shotDefault;
    pauseAll();
    renderDisplay();
  });
  stopAllBtn.addEventListener('click', ()=>{ pauseAll(); gameTime = 0; shotTime = 0; renderDisplay(); });

  applyGameTimeBtn.addEventListener('click', ()=>{
    const v = (gameTimeInput.value || '').trim();
    // accept mm:ss or single number minutes
    let sec = null;
    if(v.includes(':')){
      const parts = v.split(':').map(p=>parseInt(p||0));
      if(parts.length===2) sec = parts[0]*60 + Math.min(59, Math.max(0, parts[1]));
    } else {
      const m = parseFloat(v);
      if(!isNaN(m)) sec = Math.round(m*60);
    }
    if(sec === null || isNaN(sec)){
      alert('Enter time as mm:ss or minutes (e.g., 10:00 or 10)');
      return;
    }
    gameTime = sec;
    // when editing game time, also update per-quarter baseline so Reset uses this
    timePerQuarter = sec;
    renderDisplay();
  });

  prevQ.addEventListener('click', ()=>{ quarter = Math.max(1, quarter-1); quarterControl.textContent = quarter; renderDisplay(); });
  nextQ.addEventListener('click', ()=>{ quarter++; quarterControl.textContent = quarter; renderDisplay(); });

  applyNamesBtn.addEventListener('click', ()=>{ renderDisplay(); });

  applyShotBtn.addEventListener('click', ()=>{
    const x = parseFloat(customShotInput.value) || 24;
    shotDefault = Math.max(1, x);
    shotTime = shotDefault;
    renderDisplay();
  });
  reset24Btn.addEventListener('click', ()=>{ shotDefault = 24; customShotInput.value = 24; shotTime = shotDefault; renderDisplay(); });
  reset14Btn.addEventListener('click', ()=>{ shotDefault = 14; customShotInput.value = 14; shotTime = shotDefault; renderDisplay(); });

  swapPossBtn.addEventListener('click', ()=>{ possession = (possession === 'A') ? 'B' : 'A'; renderDisplay(); });

    // broadcast mode toggles controls and full-screen
  let broadcastMode = false;
  broadcastModeBtn.addEventListener('click', async ()=>{
    broadcastMode = !broadcastMode;
    if(broadcastMode){
      controlsPanel.style.display = 'none';
      broadcastModeBtn.textContent = 'Exit Broadcast';
      // try to request fullscreen for the display
      try{
        await broadcastDisplay.requestFullscreen?.();
      }catch(e){}
    } else {
      controlsPanel.style.display = '';
      broadcastModeBtn.textContent = 'Broadcast Mode';
      try { if(document.fullscreenElement) await document.exitFullscreen(); } catch(e){}
    }
  });

  // fullscreen independent
  fullscreenBtn.addEventListener('click', async ()=>{
    if(!document.fullscreenElement){
      await document.documentElement.requestFullscreen?.();
    } else {
      await document.exitFullscreen?.();
    }
  });

  // Save/Load state
  saveBtn.addEventListener('click', ()=>{
    const state = {
      scoreA, scoreB, foulA, foulB, quarter, possession,
      gameTime, timePerQuarter, shotDefault, shotTime,
      teamA: teamAInput.value, teamB: teamBInput.value
    };
    localStorage.setItem('bb_broadcast_state', JSON.stringify(state));
    alert('Saved locally');
  });
  loadBtn.addEventListener('click', ()=>{
    const s = localStorage.getItem('bb_broadcast_state');
    if(!s){ alert('No saved state'); return; }
    try{
      const st = JSON.parse(s);
      scoreA = st.scoreA||0; scoreB = st.scoreB||0;
      foulA = st.foulA||0; foulB = st.foulB||0;
      quarter = st.quarter||1; possession = st.possession||'A';
      gameTime = st.gameTime ?? timePerQuarter; timePerQuarter = st.timePerQuarter ?? timePerQuarter;
      shotDefault = st.shotDefault ?? shotDefault; shotTime = st.shotTime ?? shotDefault;
      teamAInput.value = st.teamA || teamAInput.value; teamBInput.value = st.teamB || teamBInput.value;
      renderDisplay();
      alert('Loaded');
    }catch(e){ alert('Failed to load: '+e); }
  });

  // keyboard shortcuts
  window.addEventListener('keydown', (e)=>{
    // avoid typing in inputs triggering shortcuts
    const tag = document.activeElement && document.activeElement.tagName.toLowerCase();
    if(tag === 'input' || tag === 'textarea') {
      // allow Escape to blur
      if(e.key === 'Escape') document.activeElement.blur();
      return;
    }
    if(e.code === 'Space'){ e.preventDefault(); if(running) pauseAll(); else startAll(); }
    if(e.key === 'r' || e.key === 'R'){ // reset clocks to baseline
      gameTime = timePerQuarter; shotTime = shotDefault; renderDisplay();
    }
    if(e.key === 's' || e.key === 'S'){ shotTime = shotDefault; renderDisplay(); }
    if(e.key === '1'){ scoreA += 1; possession='B'; shotTime = shotDefault; renderDisplay(); }
    if(e.key === '2'){ scoreA += 2; possession='B'; shotTime = shotDefault; renderDisplay(); }
    if(e.key === '3'){ scoreA += 3; possession='B'; shotTime = shotDefault; renderDisplay(); }
    if(e.key === '7'){ scoreB += 1; possession='A'; shotTime = shotDefault; renderDisplay(); }
    if(e.key === '8'){ scoreB += 2; possession='A'; shotTime = shotDefault; renderDisplay(); }
    if(e.key === '9'){ scoreB += 3; possession='A'; shotTime = shotDefault; renderDisplay(); }
    if(e.key === 'b' || e.key === 'B'){ broadcastModeBtn.click(); }
    if(e.key === 'f' || e.key === 'F'){ fullscreenBtn.click(); }
  });

  // initial render
  renderDisplay();

  // expose for debugging if needed
  window._broadcastScoreboard = {
    getState: ()=>({scoreA,scoreB,foulA,foulB,quarter,poss:possession,gameTime,shotTime}),
    start: startAll, pause: pauseAll
  };
})();
</script>
</body>
</html>
